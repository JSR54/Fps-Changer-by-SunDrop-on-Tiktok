local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

local Window = Rayfield:CreateWindow({
   Name = "FPS Changer by SunDrop on TikTok",
   LoadingTitle = "FPS Changer",
   LoadingSubtitle = "by SunDrop",
   ConfigurationSaving = { Enabled = false }
})

local Tab = Window:CreateTab("Performance", 4483362458)

-- LOW FPS
Tab:CreateToggle({
   Name = "Low FPS Mode",
   CurrentValue = false,
   Flag = "LowFPS",
   Callback = function(Value)
      if Value then
         setfpscap(30)
      else
         setfpscap(0)
      end
   end,
})

-- FPS COUNTER
local fpsCounterEnabled = false

Tab:CreateToggle({
   Name = "FPS Counter",
   CurrentValue = false,
   Flag = "FPSCounter",
   Callback = function(Value)
      fpsCounterEnabled = Value
      if Value then
         task.spawn(function()
            while fpsCounterEnabled do
               local fps = math.floor(1 / RunService.RenderStepped:Wait())
               print("FPS: " .. fps)
            end
         end)
      end
   end,
})

-- HIGH FPS MODE (Hide objects past 30 studs)
local hiddenObjects = {}
local highFPSRunning = false
local distanceLimit = 30

local function getCharacter()
   return LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
end

local function hideFarObjects()
   local character = getCharacter()
   local hrp = character:WaitForChild("HumanoidRootPart")

   for _, obj in ipairs(workspace:GetDescendants()) do
      if obj:IsA("BasePart") and not obj:IsDescendantOf(character) then
         local dist = (obj.Position - hrp.Position).Magnitude
         if dist > distanceLimit then
            if not hiddenObjects[obj] then
               hiddenObjects[obj] = {
                  Transparency = obj.Transparency,
                  CanCollide = obj.CanCollide
               }
               obj.Transparency = 1
               obj.CanCollide = false
            end
         end
      end
   end
end

local function restoreObjects()
   for obj, data in pairs(hiddenObjects) do
      if obj and obj.Parent then
         obj.Transparency = data.Transparency
         obj.CanCollide = data.CanCollide
      end
   end
   hiddenObjects = {}
end

Tab:CreateToggle({
   Name = "High FPS Mode (Hide Far Objects)",
   CurrentValue = false,
   Flag = "HighFPS",
   Callback = function(Value)
      highFPSRunning = Value
      if Value then
         setfpscap(999)
         task.spawn(function()
            while highFPSRunning do
               hideFarObjects()
               task.wait(1)
            end
         end)
      else
         setfpscap(0)
         restoreObjects()
      end
   end,
})
